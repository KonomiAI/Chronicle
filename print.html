<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Konomi Docs</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Internal Documents">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Intro</a></li><li class="chapter-item expanded affix "><li class="part-title">Design</li><li class="chapter-item expanded "><a href="design/proposal.html">Project Proposal</a></li><li class="chapter-item expanded "><a href="design/mvp_scope.html">MVP Scope</a></li><li class="chapter-item expanded "><a href="design/tech_stack.html">Tech Stack</a></li><li class="chapter-item expanded "><a href="design/database.html">Database Design</a></li><li class="chapter-item expanded "><a href="design/user_stories.html">User Stories</a></li><li class="chapter-item expanded "><a href="design/custom-form.html">Custom Form Design</a></li><li class="chapter-item expanded "><a href="design/data_analytics.html">Data analytics system Design</a></li><li class="chapter-item expanded affix "><li class="part-title">User Manual</li><li class="chapter-item expanded "><a href="user-manual/introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="user-manual/custom-fields.html">Custom form</a></li><li class="chapter-item expanded "><a href="user-manual/staff-management.html">Manage staff</a></li><li class="chapter-item expanded affix "><li class="part-title">Appendix</li><li class="chapter-item expanded "><a href="design/glossary.html">Glossary</a></li><li class="chapter-item expanded "><a href="misc/useful-links.html">Useful Links</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Konomi Docs</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="konomiai-documentation"><a class="header" href="#konomiai-documentation">Konomi.ai Documentation</a></h1>
<p>This is where we store all meeting minutes, API reference and product documentation!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="spa-patient-record-management-system"><a class="header" href="#spa-patient-record-management-system">SPA patient record management system</a></h1>
<h2 id="problem-description"><a class="header" href="#problem-description">Problem Description</a></h2>
<p>On a daily basis, our client has to track customer experience and manage practice related information. Their current solution involves saving records on paper and public cloud softwares like OneDrive. This solution has limits when it comes to scalability, customizability, and reportability. The solution also has limited searchability and is time consuming to build reports. Therefore, the client is seeking a solution for an affordable and scalable practice management software that allows them to track customer experience and improve team productivity.</p>
<h2 id="proposed-solution"><a class="header" href="#proposed-solution">Proposed Solution</a></h2>
<p>We propose a cloud hosted, on-premise available customer management tool that allows the client to create and manage customer profiles, record details throughout customer visits, and generate comprehensive reports to improve customer experiences. The solution will support user identity, customizable forms, enhanced user inputs, full-text search, data reporting, and AI enabled analytics. Our solution will simplify customer visit tracking and improve user experience.</p>
<h2 id="areas-of-focus"><a class="header" href="#areas-of-focus">Areas of focus:</a></h2>
<ul>
<li>User identity for customers, employees and administrators</li>
<li>Data collection with customizable forms</li>
<li>External service integrations</li>
<li>Full-text search</li>
<li>Security &amp; privacy</li>
<li>AI enabled natural language processing and analytics</li>
</ul>
<h2 id="stakeholder-contact"><a class="header" href="#stakeholder-contact">Stakeholder Contact:</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Email</th></tr></thead><tbody>
<tr><td>Carina Wong</td><td>carina@pemberleysprings.com</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="mvp-scope"><a class="header" href="#mvp-scope">MVP Scope</a></h1>
<p>The following represents the scope of our Minimum Viable Product (MVP) with a delivery target of April 2022.</p>
<h2 id="top-priority-must-have"><a class="header" href="#top-priority-must-have">Top priority (Must have)</a></h2>
<ul>
<li>Customer profile
<ul>
<li>Core fields</li>
</ul>
</li>
<li>Activity entry</li>
<li>Inventory
<ul>
<li>only the data structure &amp; reading the data</li>
</ul>
</li>
<li>Customizable IP whitelist</li>
<li>Identify staff for logging</li>
<li>user identity</li>
<li>Role based access control</li>
<li>One hard coded statistic report generation</li>
</ul>
<h2 id="medium-priority-nice-to-have"><a class="header" href="#medium-priority-nice-to-have">Medium priority (Nice to have)</a></h2>
<ul>
<li>Customer profile
<ul>
<li>Custom fields</li>
</ul>
</li>
<li>Customizable roles/permissions</li>
<li>User identity management</li>
<li>Audit log</li>
</ul>
<h2 id="low-priority-stretch-goals"><a class="header" href="#low-priority-stretch-goals">Low priority (Stretch goals)</a></h2>
<ul>
<li>Custom stat reports
<ul>
<li>automated time based</li>
<li>manual reports</li>
<li>report templates</li>
</ul>
</li>
<li>Inventory
<ul>
<li>Management UI</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="konomiai-chronicle-technology-stack"><a class="header" href="#konomiai-chronicle-technology-stack">Konomi.ai Chronicle Technology Stack</a></h1>
<h2 id="front-end"><a class="header" href="#front-end">Front end</a></h2>
<ul>
<li>Platform: Web</li>
<li>Language: TypeScript</li>
<li>UI Framework: React SPA</li>
<li>Build tool: Vite</li>
<li>Styling: MUI</li>
<li>Libraries:
<ul>
<li>Data layer: React Query</li>
<li>Form handling: React Hook Form</li>
<li>State management: Zustand</li>
</ul>
</li>
<li>Testing:
<ul>
<li>Unit test: Vitest</li>
<li>E2E test: CypressJS</li>
</ul>
</li>
</ul>
<h2 id="back-end"><a class="header" href="#back-end">Back end</a></h2>
<ul>
<li>Platform: NodeJS</li>
<li>Language: TypeScript</li>
<li>Framework: NestJS</li>
<li>Testing:
<ul>
<li>Jest</li>
</ul>
</li>
<li>Database:
<ul>
<li>MongoDB</li>
</ul>
</li>
<li>Libraries
<ul>
<li>OR(D)M: Prisma/Mongoose</li>
</ul>
</li>
</ul>
<h2 id="infrastructure-management"><a class="header" href="#infrastructure-management">Infrastructure management</a></h2>
<ul>
<li>IaaC: Terraform</li>
<li>CI: GitHub Action</li>
<li>Cloud Service Provider: GCP</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="database-design"><a class="header" href="#database-design">Database Design</a></h1>
<pre class="mermaid">erDiagram

    Log_Trail {
        datetime timestamp
        string action
    }
    Permission {
        string feature
        string operation
    }
    Role {
        string name
        list permissions
    }
    Staff {
        string name
    }
    Entry {}
    Customer {
        string name
    }
    Form_Type{
        string name
    }
    Form {
        string name
        datetime version
        object sections
    }
    Response {
        datetime form_version
        object response
    }
    Form_Components {}
    Inventory {
        string name
        list variants
        float price
    }
    Activity {
        string name
        float price
    }

    Permission }|--|{ Role: in
    Role }o--o{ Staff: in
    Staff }o--|{ Entry: associated
    Entry }o--|| Customer: associated
    Entry }|--o{ Form_Type: has
    Form_Type }|--|| Form: has
    Form }|--o{ Form_Components: has
    Form ||--o{ Response: has
</pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="user-stories"><a class="header" href="#user-stories">User Stories</a></h1>
<h2 id="identity-access-control"><a class="header" href="#identity-access-control">Identity Access Control</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
As an Owner, I want to be able to update the IP Whitelist, so I can prevent offsite activities.</li>
<li><input disabled="" type="checkbox"/>
As an Owner, I want to ensure my staff cannot access the data from an unknown IP address. So I can protect the privacy of my customers</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to add staff to the system, so other staff could access the system as well.</li>
<li><input disabled="" type="checkbox"/>
As a staff, I want to be able to reset another staff's account password, so they can regain access if they forgot their password</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to view the email and role details of another staff</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to view the roles created for my company, so I can create missing roles and update existing ones</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to suspend other staff accounts so I can prevent them from accessing the system.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to delete a staff account, so I can remove their personal information from the system.</li>
<li><input disabled="" type="checkbox"/>
As an owner, I want to be able to view the IP addresses I allow- [ ] listed, so I can add new ones and remove old ones.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to create roles, so that nothing more than the required permissions are given.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to update staff roles, so other staff can get access to what they need.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to update other staff account's details, so that their information can be up to date.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to update existing roles, so that only the correct permissions are given to other staff.</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I want to be able to sign into the dashboard using my username and password</li>
</ul>
<h2 id="inventory"><a class="header" href="#inventory">Inventory</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to create treatment or physical goods</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to track the price of physical goods</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to support internal client's own id in the form of an SKU</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to support universal barcode scanning for physical goods</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to update all attributes of a product</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to delete inventory items</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to find inventory items by names</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to find inventory items by SKU</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to find physical goods by barcode</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to manage variants and automatically generate a table of variants based on options</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to manage variants and change price/SKU/barcode for each item</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to manage variants and customize product options (option name, list of options)</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to mark a product/service as unavailable</li>
<li><input disabled="" type="checkbox"/>
As a staff member, I should be able to manage variants and change price/SKU/barcode for any number of variants selected (stretch goal)</li>
</ul>
<h2 id="data-reporting"><a class="header" href="#data-reporting">Data Reporting</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
As an owner, I want standard reports sent to me on a periodic basis (EOD/EOW)</li>
<li><input disabled="" type="checkbox"/>
As an owner, I want to be able to specify what information is in a report</li>
<li><input disabled="" type="checkbox"/>
As an owner, I want to be able to see the list of activities that were performed at a specified period of time</li>
<li><input disabled="" type="checkbox"/>
As an owner, I want to be able to see the items and variations bought by customers during a specified period of time</li>
<li><input disabled="" type="checkbox"/>
As an owner, I want to be able to view membership attendance and new members onboarded</li>
</ul>
<h2 id="forms"><a class="header" href="#forms">Forms</a></h2>
<ul>
<li><input disabled="" type="checkbox"/>
<p>The system shall record when a staff member edits a form response</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to make edits to a form response</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to create a form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>The system shall have preset forms with the following fields<br />
- customer info: first name, last name, DoB, sex, gender, email, phone number<br />
- medical record: height, weight, allergies, conditions, additional notes<br />
- membership purchase/renewal (out of mvp scope): email, phone number (tied to customer info) level, date<br />
- Activity Entry: treatment, price, date/time, general notes, critical notes, and photos<br />
- Purchase/Transaction entry: product name, size, barcode, price</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>The system should validate data before writing to the database to ensure consistency.</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to create new fields on an existing form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to delete fields on a existing form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to view form responses</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to view forms</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>The system shall have a unique ID for each customer</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>The system shall validate fields of a form before saving to the database.</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>The system shall associate form responses with the respective customer and provider</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to delete a form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to fill out a form response</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to add sections to a form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a staff member, I want to be able to delete sections on a form</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a provider, I should be able to search for specific entries involved with specific customers.</p>
</li>
<li><input disabled="" type="checkbox"/>
<p>As a provider, I should be able to view all a customer’s entries under their profile</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="customizable-form-system"><a class="header" href="#customizable-form-system">Customizable form system</a></h1>
<p>One key feature of our application is that it allows users to create their own forms and attach those forms to entities like customers, daily visits, products etc. The app also allows the user to perform analytics and data reporting using the custom data. This document will discuss a few ways to implement custom fields in our system.</p>
<h2 id="components-of-the-system"><a class="header" href="#components-of-the-system">Components of the system</a></h2>
<p>There are three components to the system.</p>
<ol>
<li>The template schema</li>
<li>Forms</li>
<li>Responses</li>
</ol>
<h3 id="the-template-schema"><a class="header" href="#the-template-schema">The template schema</a></h3>
<p>The template schema is a json schema managed by the Konomi.ai team. This schema defines the possible shape of tenant forms. The schema includes all allowed field types, field properties and form structure information.</p>
<p>The template is in the shape of a json schema version 7</p>
<h3 id="forms-1"><a class="header" href="#forms-1">Forms</a></h3>
<p>Forms are created by tenants and used within the tenancy. The shape of the forms are governed by the template schema. All forms must pass a schema test before responses can be made to the form.</p>
<p>The form shape is sanctioned by the template schema, upon saving a form, a new json schema will be generated to validate form responses.</p>
<h3 id="responses"><a class="header" href="#responses">Responses</a></h3>
<p>Responses are created by tenants's staff and are associated with a particular version of a form version. The response must pass a schema test before it can be used.</p>
<h2 id="form-features"><a class="header" href="#form-features">Form Features</a></h2>
<h3 id="validation"><a class="header" href="#validation">Validation</a></h3>
<p>Every response is validated against the version of the form it is responding to, this ensures that all fields are valid before the user can save a response. Response validation happens on the client first and then on the server. The validation logic is handled by the <code>c-form</code> package which includes helper function that take in a form definition and validate against it.</p>
<p>Currently, we aim to support optional fields first. In the future we want to support more complex field validation logic.</p>
<h3 id="versioning"><a class="header" href="#versioning">Versioning</a></h3>
<p>A core design of the form is the ability to keep track of versions for forms and responses. When a change is made to a form/response, a new version of the entity will be created, this will ensure a full track of audit history on changes and allow the ability to rollback potential changes. This also keeps the database sain for the sake of the developers.</p>
<h3 id="field-types"><a class="header" href="#field-types">Field types</a></h3>
<p>The form will support the following form types for now:</p>
<ol>
<li>Short text - usually text within one line</li>
<li>Long text - text that can span multiple paragraphs</li>
<li>Multiple choice - select an option from a list of possible options</li>
<li>Multi select - select up to a number of options from a list of possible options</li>
<li>Number - an input that can only be a numerical value (no scientific values allowed)</li>
</ol>
<h3 id="load-multiple-choice-options-from-server"><a class="header" href="#load-multiple-choice-options-from-server">Load multiple choice options from server</a></h3>
<p>The system will be able to load multiple choice options dynamically using REST APIs.</p>
<h3 id="connection-with-entities"><a class="header" href="#connection-with-entities">Connection with entities</a></h3>
<p>Entities like activity entry, customers, etc. will have a new responses field. This will keep track of all the responses that was filled for the entity.</p>
<p>For activity entry, upon creation, all forms with activity entry as the purpose is loaded. The user selects one form and completes it. Then users can add any number of activity entry, or null purpose forms to the entry.</p>
<p>For all other entities, by default all forms whose purpose is matching the entity are required to be completed. Then users can attach any additional fields.</p>
<h2 id="form-management-lifecycle"><a class="header" href="#form-management-lifecycle">Form management lifecycle</a></h2>
<h3 id="create-new-form"><a class="header" href="#create-new-form">Create new form</a></h3>
<pre class="mermaid">sequenceDiagram
  autonumber
  participant Client
  participant Server
  participant Database
  Client-&gt;&gt;Client: Validate form with c-form
  Client-&gt;&gt;Server: Send created form to server
  Server-&gt;&gt;Server: Validate form with c-form
  Server-&gt;&gt;Database: Save new form
  activate Database
  Database--&gt;&gt;Server: Form saved with ID
  deactivate Database
  Server--&gt;&gt;Client: Form created with ID
</pre>
<h3 id="update-existing-form"><a class="header" href="#update-existing-form">Update existing form</a></h3>
<pre class="mermaid">sequenceDiagram
  autonumber
  participant Client
  participant Server
  participant Database
  Client-&gt;&gt;Client: Validate form with c-form
  Client-&gt;&gt;Server: Send updated form to server
  Server-&gt;&gt;Server: Validate form with c-form
  Server-&gt;&gt;Database: Save updated form as draft
  activate Database
  Database--&gt;&gt;Server: Form saved with ID
  deactivate Database
  Server--&gt;&gt;Client: Form draft saved with ID
  Client-&gt;&gt;Server: Update form to draft version
  Server-&gt;&gt;Database: Update form to draft version
  Database--&gt;&gt;Server: Form version updated to draft version
  Server--&gt;&gt;Client: Form version updated to draft version
</pre>
<h2 id="database-design-1"><a class="header" href="#database-design-1">Database design</a></h2>
<p>Here we describe the proposed database design for this system</p>
<pre class="mermaid">erDiagram
  form ||--|| latestForm  : uses
  form ||--|{ formVersion : versions
  form {
    string id
    string templateVersion
    string purpose
  }
  formVersion ||--o| latestForm : is
  formVersion {
    string id
    string formVersionId
    json formData
  }
  response |o--|| formVersion : responsesTo
  response ||--|| latestResponse : uses
  response ||--|{ responseVersion : versions
  response {
    string id
  }
  responseVersion ||--o| latestResponse : is
  responseVersion {
    string id
    json responseData
  }
</pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-analytics-system-design"><a class="header" href="#data-analytics-system-design">Data analytics system design</a></h1>
<p>We want to help our customers better understand the performance of their business and gain insights from the data they collect. To achieve this goal, we designed a powerful analytics system with progressive improvements in mind.</p>
<h2 id="setting-the-goals"><a class="header" href="#setting-the-goals">Setting the goals</a></h2>
<p>The first issue we tackled as a team is to understand the goal of our analytics service and the MVP scope of the service. From there we setup a future outlook on the features we want to see the service deliver.</p>
<p>Through discussion, we decided that the goal of our analytics service is:</p>
<ul>
<li>Customizable</li>
<li>Easy to use</li>
<li>Comprehensive &amp; Dynamic</li>
</ul>
<h3 id="customizable"><a class="header" href="#customizable">Customizable</a></h3>
<p>We want to build a service where the customer can have maximum control over the reports they generate, they can chose the filtering criteria, select the column and aggregations and more importantly receive the data in the format they prefer.</p>
<p>For our MVP product, we want the user to be able to set the time-based filtering criteria, select the columns to display and data to aggregate. We plan on generating JSON and in-app table as the initial export solution</p>
<p>In the future we plan on implementing the following capabilities.</p>
<ul>
<li>Filter data with more fields</li>
<li>Customizable aggregation techniques (average, min, max over period)</li>
<li>More data exporting methods (CSV, XLSX, or to other analytics services)</li>
</ul>
<h3 id="easy-to-use"><a class="header" href="#easy-to-use">Easy to use</a></h3>
<p>We want to build an analytics service that does not require a degree in data science to use. For that we need a simple and streamlined customer experience with the ability to build commonly used reports with a click of a button.</p>
<p>For our MVP product we will include handcrafted templates that customers can implement without fiddling with a bunch of filters and form controls.</p>
<p>In the future we plan on making the system more accessible by adding:</p>
<ul>
<li>Column suggestions</li>
<li>Automatically generated reports</li>
<li>In-app data visualization with charts</li>
</ul>
<h3 id="comprehensive-and-dynamic"><a class="header" href="#comprehensive-and-dynamic">Comprehensive and dynamic</a></h3>
<p>We want to ensure our focus of ease-of-use and accessibility does not hamper the clients' capability to perform more advanced analytical tasks. For that we have.</p>
<p>For the MVP, we want to build predefined aggregation views that cover at least 90% of the client's analytics use cases.</p>
<p>In the future we will add:</p>
<ul>
<li>The ability to aggregate any column</li>
<li>The ability to set aggregation window sizes</li>
<li>The ability to work with data from user generated custom forms</li>
<li>Multiple data sources on a single table to see relationship between data sources (a)</li>
</ul>
<h2 id="building-the-mvp"><a class="header" href="#building-the-mvp">Building the MVP</a></h2>
<p>To summarize, the MVP version of the data analytics will have pre-defined aggregation capabilities and not feature data from customizable forms.</p>
<h3 id="understanding-the-data"><a class="header" href="#understanding-the-data">Understanding the data</a></h3>
<p>The first goal was to understand the data we have collected through the 4 major business focused models of the application</p>
<ul>
<li>Customer</li>
<li>Inventory</li>
<li>Staff</li>
<li>Activity Entry</li>
</ul>
<p>We selected the following aggregations to integrate in the MVP</p>
<div class="table-wrapper"><table><thead><tr><th>Data Source</th><th>Aggregations</th></tr></thead><tbody>
<tr><td>Customer</td><td><ul><li>Visits in period</li><li>Amount spent in period</li></ul></td></tr>
<tr><td>Staff</td><td><ul><li>Entries performed in selected period</li><li>Amount earned in selected period</li><li>Activities performed in period</li><li>Products sold in a period</li></ul></td></tr>
<tr><td>Activity</td><td><ul><li>County in period</li><li>Revenue in period</li></ul></td></tr>
<tr><td>Products</td><td><ul><li>Count in period</li><li>Revenue period</li></ul></td></tr>
</tbody></table>
</div>
<h3 id="aggregating-the-data"><a class="header" href="#aggregating-the-data">Aggregating the data</a></h3>
<p>The data will be aggregated and processed on the service and not in the database, this is due to the concern of the limited capabilities of our MongoDB instance. Data will be mapped on the API.</p>
<p>This is also due to the fact that for our service, the API can scale quickly (new instance ready in under 500ms) and the database cannot do so as quickly.</p>
<h3 id="saving-the-reports"><a class="header" href="#saving-the-reports">Saving the reports</a></h3>
<p>Once a report is generated, the report will be sent to the client and also saved in the database alongside the configuration template. The user will be able to come back to the report anytime without needing to perform the aggregation again.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Chronicle is not only for collecting personal care practice data, it is also designed to help business owners to gain insights in their business from the data collected, this will help them make more informed decisions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chronicle-user-manual"><a class="header" href="#chronicle-user-manual">Chronicle User Manual</a></h1>
<p>This is the user manual for Konomi.ai's Chronicle app. Chronicle is a personal practice tracking, customer relations management (CRM) application that aims to simplify the way you and your business track practice data and customer engagement.</p>
<h2 id="table-of-content"><a class="header" href="#table-of-content">Table of content</a></h2>
<p>TODO</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="customizable-forms"><a class="header" href="#customizable-forms">Customizable forms</a></h1>
<p>Often, businesses have custom data collection requirements and forms that are tailored to their specific organization. Chronicle accommodates this by supporting the ability to create &quot;custom forms&quot;. Custom forms are Google Form like forms where you can add questions, set validation rules and require your staff to fill out during any business process, whether that's creating a new customer profile, logging a service entry, or enrolling a new staff member. Custom forms allow you to collect and analyze data the way you want.</p>
<h2 id="how-to-access-custom-forms"><a class="header" href="#how-to-access-custom-forms">How to access custom forms</a></h2>
<p>To see your custom forms and mange them:</p>
<ol>
<li>click on the <strong>Customize Forms</strong> option on the side navigation</li>
<li>You should see a list of all custom forms in your organization.</li>
</ol>
<h3 id="what-if-i-dont-see-the-option-on-the-side-navigation"><a class="header" href="#what-if-i-dont-see-the-option-on-the-side-navigation">What if I don't see the option on the side navigation?</a></h3>
<p>If the <strong>Customize Forms</strong> option is not available for you, it likely means you do not have access to the feature. Ask your administrator to grant you access to custom forms to access the feature.</p>
<h2 id="how-to-create-a-new-custom-form"><a class="header" href="#how-to-create-a-new-custom-form">How to create a new custom form</a></h2>
<p>To create a new custom form follow the following instructions,</p>
<ol>
<li>Access the custom form list, you can follow the instructions above if you need assistance.</li>
<li>Click the <strong>Create</strong> button on the page.</li>
</ol>
<p>You are now navigated to a new form creation page, follow the form to create your form.</p>
<ol>
<li>Make sure to provide a title and description for your form, forms with clear description and title are more likely to be used.</li>
<li>Select a purpose for the form, forms with specific purpose are displayed before all other forms when used by your staff, they are also marked as <strong>recommended</strong>.</li>
<li>Give your first section a title, every form must have at least one section and one question.</li>
<li>Add a question to the new section, a question must have a title.</li>
<li>You can change the question type using the <strong>Question type</strong> dropdown next to the question title</li>
<li>For <em>multiple choice</em> and <em>multi-select questions</em>, you must also create a list of options, add option titles and press <strong>Add option</strong> to create more options</li>
<li>For <em>dynamic data select</em> questions, you must select a data source to populate the options from.</li>
<li>You can add a description to a question by clicking <strong>Add description</strong>, question descriptions are optional</li>
<li>You can make a question optional to complete by unchecking the <strong>required</strong> toggle.</li>
<li>You can add more questions to the section by clicking on <strong>Add question</strong>.</li>
<li>You can add more sections to the form by clicking on <strong>Add new section</strong>.</li>
<li>Make sure to press save at the bottom of the page when you are done.</li>
</ol>
<h2 id="update-an-existing-form"><a class="header" href="#update-an-existing-form">Update an existing form</a></h2>
<p>When you update an existing form, Chronicle creates a new version of the form and maintains the previous versions just in case they are being used in existing activity entries. This system ensures you will not lose any existing data when modifying form fields. You currently can't browse previous versions of your form, we are actively working to enable this feature.</p>
<p>Steps:</p>
<ol>
<li>Access the custom form list, you can follow the instructions above if you need assistance.</li>
<li>Click on the form you want to update.</li>
<li>Follow the create form guide for details on how to use the form builder.</li>
</ol>
<h2 id="custom-form-best-practices"><a class="header" href="#custom-form-best-practices">Custom form best practices</a></h2>
<ul>
<li>While it is possible to create a form with no sections and no question, this is not a recommended practice.</li>
<li>Use the paragraph option if you want your staff to provide text responses longer than a sentence.</li>
<li>It is recommended to not delete fields from forms that are being used. While it will not affect any existing entries, you may potentially lose track of data.</li>
</ul>
<h2 id="custom-form-limitations-and-in-progress-features"><a class="header" href="#custom-form-limitations-and-in-progress-features">Custom form limitations and in-progress features</a></h2>
<ul>
<li></li>
<li>Currently you cannot reorder the fields you created, this is an in-development feature.</li>
<li>Currently you cannot duplicate an existing field, this is an in-development feature.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="staff--role-management"><a class="header" href="#staff--role-management">Staff &amp; role management</a></h1>
<p>Chronicle features a robust staff management system that allows you to track staff information, grant access to specific parts of the system and gain performance insights.</p>
<p><em>Before proceeding, make sure you are signed in as the super user or you are a user with write access to security feature. This feature is granted to all users with the built-in administrator role</em></p>
<h2 id="role-management"><a class="header" href="#role-management">Role Management</a></h2>
<p>You can view, create and update your roles in the system.</p>
<h3 id="create-a-new-role"><a class="header" href="#create-a-new-role">Create a new role</a></h3>
<p>Steps:</p>
<ol>
<li>Click on Security on the side menu to show all security menu options, click on <strong>Roles</strong>.</li>
<li>Click <strong>Create new role</strong></li>
<li>Provide a name and a description for the role.</li>
<li>Select all accesses the role has in the system, note if a user has write permission in a role, they will automatically be granted read permission.</li>
<li>Remember to click <strong>Save</strong> at the bottom of the page.</li>
</ol>
<h3 id="update-an-existing-role"><a class="header" href="#update-an-existing-role">Update an existing role</a></h3>
<p>Steps:</p>
<ol>
<li>Click on security on the side menu to show all security menu options, click on <strong>Roles</strong></li>
<li>Select the role you want to update</li>
<li>Make the necessary changes in the form</li>
<li>Click <strong>Save</strong> when you are done</li>
</ol>
<h3 id="deleting-a-role"><a class="header" href="#deleting-a-role">Deleting a role</a></h3>
<p>Steps:</p>
<ol>
<li>Click on security on the side menu to show all security menu options, click on <strong>Roles</strong></li>
<li>Select the role you want to delete</li>
<li>Make the necessary changes in the form</li>
<li>Click <strong>delete</strong> in the danger zone section of the page. You cannot delete a role if it is assigned to a staff, even if the staff is no longer active. Remove the role from the staff or delete the staff to delete the role.</li>
</ol>
<h2 id="staff-management"><a class="header" href="#staff-management">Staff management</a></h2>
<p>You can currently create and manage staff information using the security feature of Chronicle. We are currently recording basic information about the staff, and are planning to allow custom forms be connected to staff records soon.</p>
<h3 id="invite-a-new-staff"><a class="header" href="#invite-a-new-staff">Invite a new staff</a></h3>
<p>Steps:</p>
<ol>
<li>Access the staff list by clicking on <strong>Staff</strong> on the side menu, if you don't see <strong>Staff</strong>, click on <strong>Security</strong> to see the option.</li>
<li>Click <strong>Invite</strong></li>
<li>Fill in the form that showed up in the dialog</li>
<li>A temporary password will be created for the staff, take a note of the password as it is only shown once.</li>
<li>Send the login credentials to your staff member, they will be able to sign in using the credentials provided.</li>
</ol>
<h3 id="reset-a-staff-members-password"><a class="header" href="#reset-a-staff-members-password">Reset a staff member's password</a></h3>
<p>If your staff member forgot their login credentials, you can reset it using the staff details page.</p>
<p>Steps:</p>
<ol>
<li>Access the staff list by clicking on <strong>Staff</strong> on the side menu, if you don't see <strong>Staff</strong>, click on <strong>Security</strong> to see the option.</li>
<li>Click on the staff that requested assistance</li>
<li>Click <strong>Reset password</strong>, then confirm the intent to reset the password.</li>
<li>A temporary password will be created for the staff, take a note of the password as it is only shown once.</li>
<li>Send the login credentials to your staff member, they will be able to sign in using the credentials provided.</li>
</ol>
<p>Notes:</p>
<p><em>The staff will not be signed out of the app if you reset their password, we are working on a system to force sign out the user.</em></p>
<h3 id="update-a-staff-members-profile"><a class="header" href="#update-a-staff-members-profile">Update a staff member's profile</a></h3>
<p>The process is the same as resetting the password, just update the fields in the form and remember to press save.</p>
<h3 id="deleting-a-staff-member"><a class="header" href="#deleting-a-staff-member">Deleting a staff member</a></h3>
<p>When you delete a staff member, their record is not remove entirely. Instead we erase any personal information recorded about the staff member. This includes their email, name, gender, and any associated custom forms.</p>
<p>Steps:</p>
<ol>
<li>Go to the staff member's details page.</li>
<li>Suspend the staff first by clicking on <strong>Suspend</strong>, this will disable the user's access to the system immediately.</li>
<li>You can delete suspended staff by clicking on the <strong>Delete</strong> button in the danger zone</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chronicle-glossary"><a class="header" href="#chronicle-glossary">Chronicle Glossary</a></h1>
<p>The following are terms used in Chronicle and what they mean</p>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Definition</th></tr></thead><tbody>
<tr><td>Activity</td><td>A treatment provided to a customer, usually intangible like massage or haircut.</td></tr>
<tr><td>Entry</td><td>A transaction recorded by the staff that describes an activity performed by a customer.</td></tr>
<tr><td>Inventory</td><td>A collection of products and activities offered by a tenant.</td></tr>
<tr><td>Product</td><td>A physical good sold to a customer, like a bottle of cream or a t-shirt.</td></tr>
<tr><td>Report</td><td>A customizable document with data aggregated from Chronicle.</td></tr>
<tr><td>Tenant</td><td>The client's company, store, or establishment using Chronicle for managing entries.</td></tr>
<tr><td>Visit</td><td>TODO</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="useful-links"><a class="header" href="#useful-links">Useful links</a></h1>
<p>Here are some useful links to navigate around the Chronicle project</p>
<h3 id="figma"><a class="header" href="#figma">Figma</a></h3>
<ul>
<li><a href="https://www.figma.com/file/CSDPY2LRme3hymSE8tnsIq/Chronicle?node-id=0%3A1">Design Board</a></li>
<li><a href="https://www.figma.com/proto/CSDPY2LRme3hymSE8tnsIq/Chronicle?node-id=24%3A81&amp;scaling=scale-down&amp;page-id=0%3A1&amp;starting-point-node-id=24%3A81&amp;show-proto-sidebar=1">Prototypes</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
